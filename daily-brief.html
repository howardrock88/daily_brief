<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å¤§è’œç²’æœºç ”æ‰€è¡Œä¸šæ—©æŠ¥</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&display=swap" rel="stylesheet">
  <style>
    * { font-family: 'Noto Sans SC', sans-serif; }
    .card { transition: all 0.3s ease; }
    .card:hover { transform: translateY(-4px); }
    .section-title { border-left: 4px solid; }
    .section-focus { border-color: #f97316; }
    .section-funding { border-color: #22c55e; }
    .section-tech { border-color: #3b82f6; }
    .section-news { border-color: #a855f7; }
  </style>
</head>
<body class="bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 min-h-screen">
  <div class="container mx-auto px-4 py-8 max-w-5xl">
    <!-- å¤´éƒ¨ + æœç´¢ -->
    <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4">
      <div>
        <h1 class="text-4xl md:text-5xl font-bold text-white mb-2">ğŸ¤– å¤§è’œç²’æœºç ”æ‰€è¡Œä¸šæ—©æŠ¥</h1>
        <p class="text-purple-300 text-lg">æ¯å¤©è‡ªåŠ¨æ›´æ–° Â· æœºå™¨äººå’ŒAIè¡Œä¸šèµ„è®¯</p>
      </div>
      <div class="relative">
        <span class="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400">ğŸ”</span>
        <input type="text" id="search" placeholder="æœç´¢æ–°é—»..." 
          oninput="filterCards()"
          class="pl-10 pr-4 py-3 bg-white/10 border border-white/20 rounded-xl text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-purple-500 w-full md:w-64">
      </div>
    </div>

    <!-- å¡ç‰‡å®¹å™¨ -->
    <div id="cards" class="grid gap-6"></div>
    
    <!-- æ— ç»“æœæç¤º -->
    <div id="no-result" class="hidden text-center py-12">
      <p class="text-purple-300 text-lg">æ²¡æœ‰æ‰¾åˆ°ç›¸å…³æ–°é—»</p>
    </div>
  </div>

  <script>
    const REPO = 'howardrock88/daily_brief';
    const DATA_FILE = 'daily-brief.json';

    let allBriefs = [];
    let currentBrief = null;

    // åŠ è½½æ‰€æœ‰æ—©æŠ¥æ•°æ®
    async function loadData() {
      try {
        const response = await fetch(`https://raw.githubusercontent.com/${REPO}/main/${DATA_FILE}?t=${Date.now()}`);
        if (response.ok) {
          const data = await response.json();
          renderBriefs([data]);
        }
      } catch (e) {
        console.log('åŠ è½½å¤±è´¥');
      }
    }

    // æ¸²æŸ“æ—©æŠ¥åˆ—è¡¨
    function renderBriefs(briefs) {
      allBriefs = briefs;
      const container = document.getElementById('cards');
      
      if (briefs.length === 0) {
        container.innerHTML = '<p class="text-center text-purple-300 py-12">æš‚æ— æ—©æŠ¥æ•°æ®</p>';
        return;
      }

      container.innerHTML = briefs.map((brief, idx) => `
        <div class="card bg-white/10 backdrop-blur rounded-2xl overflow-hidden cursor-pointer" onclick="openDetail(${idx})">
          <div class="p-6">
            <div class="flex justify-between items-start">
              <div>
                <h2 class="text-2xl font-bold text-white mb-1">${brief.date}</h2>
                <p class="text-purple-300 text-sm">${brief.focus.length}æ¡ç„¦ç‚¹ Â· ${brief.funding.length}æ¡èèµ„ Â· ${brief.tech.length}æ¡æŠ€æœ¯ Â· ${brief.news.length}æ¡åŠ¨æ€</p>
              </div>
              <span class="text-purple-400">ğŸ“°</span>
            </div>
            
            <div class="mt-4 flex flex-wrap gap-2">
              ${brief.focus.slice(0, 2).map(f => `
                <span class="px-3 py-1 bg-orange-500/20 text-orange-300 rounded-full text-sm">ğŸ”¥ ${f.title.slice(0, 20)}...</span>
              `).join('')}
            </div>
          </div>
        </div>
      `).join('');
    }

    // æ‰“å¼€è¯¦æƒ…
    function openDetail(idx) {
      const brief = allBriefs[idx];
      currentBrief = idx;
      
      const sections = [
        { key: 'focus', title: 'ğŸ”¥ ä»Šæ—¥ç„¦ç‚¹', class: 'section-focus', color: 'text-orange-400' },
        { key: 'funding', title: 'ğŸ’° èèµ„ä¸å¹¶è´­', class: 'section-funding', color: 'text-green-400' },
        { key: 'tech', title: 'ğŸš€ æŠ€æœ¯çªç ´', class: 'section-tech', color: 'text-blue-400' },
        { key: 'news', title: 'ğŸ­ è¡Œä¸šåŠ¨æ€', class: 'section-news', color: 'text-purple-400' }
      ];

      let html = `
        <div class="fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50" onclick="closeDetail(event)">
          <div class="bg-slate-900 rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto">
            <div class="sticky top-0 bg-slate-800/95 p-6 border-b border-white/10 flex justify-between items-center">
              <div>
                <h2 class="text-2xl font-bold text-white">${brief.date}</h2>
                <p class="text-purple-300 text-sm">å¤§è’œç²’æœºç ”æ‰€è¡Œä¸šæ—©æŠ¥</p>
              </div>
              <button onclick="closeDetail()" class="text-gray-400 hover:text-white text-2xl">&times;</button>
            </div>
            <div class="p-6 space-y-6">
      `;

      for (const section of sections) {
        const items = brief[section.key];
        if (!items || items.length === 0) continue;

        html += `
          <div>
            <h3 class="text-xl font-bold ${section.color} mb-4 flex items-center gap-2 section-title ${section.class} pl-4">
              ${section.title}
            </h3>
            <div class="grid gap-4">
              ${items.map((item, i) => `
                <div class="bg-white/5 rounded-xl p-4">
                  <h4 class="font-bold text-white mb-2">${item.title}</h4>
                  <p class="text-purple-200 mb-3 leading-relaxed">${item.desc}</p>
                  <div class="text-sm text-purple-400">æ¥æºï¼š${item.source}</div>
                </div>
              `).join('')}
            </div>
          </div>
        `;
      }

      html += `
            </div>
          </div>
        </div>
      `;

      document.body.insertAdjacentHTML('beforeend', html);
    }

    // å…³é—­è¯¦æƒ…
    function closeDetail(e) {
      if (!e || e.target === e.currentTarget) {
        const modal = document.querySelector('body > div.fixed');
        if (modal) modal.remove();
      }
    }

    // æœç´¢è¿‡æ»¤
    function filterCards() {
      const keyword = document.getElementById('search').value.toLowerCase();
      if (!keyword) {
        renderBriefs(allBriefs);
        document.getElementById('no-result').classList.add('hidden');
        return;
      }

      const filtered = allBriefs.filter(brief => {
        return brief.date.includes(keyword) ||
               brief.focus.some(f => f.title.toLowerCase().includes(keyword) || f.desc.toLowerCase().includes(keyword)) ||
               brief.funding.some(f => f.title.toLowerCase().includes(keyword) || f.desc.toLowerCase().includes(keyword)) ||
               brief.tech.some(f => f.title.toLowerCase().includes(keyword) || f.desc.toLowerCase().includes(keyword)) ||
               brief.news.some(f => f.title.toLowerCase().includes(keyword) || f.desc.toLowerCase().includes(keyword));
      });

      if (filtered.length === 0) {
        document.getElementById('cards').innerHTML = '';
        document.getElementById('no-result').classList.remove('hidden');
      } else {
        document.getElementById('no-result').classList.add('hidden');
        renderBriefs(filtered);
      }
    }

    // åˆå§‹åŒ–
    loadData();
  </script>
</body>
</html>